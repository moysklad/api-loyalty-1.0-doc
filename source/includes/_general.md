# МойСклад LoyaltyAPI

API для интеграции МоегоСклада с системами лояльности.


## Сценарий работы
 
Предваритаельные условия:
- Пользователь на стороне МоегоСклада указывает __базовый адрес системы лояльности__ (в приведенных примерах обозначен как example.com/baseurl) и __ключ доступа__ .
- Пользователь на стороне системы лояльности указывает логин и пароль для доступа к МоемуСкладу.
- Система лояльности через [JSON API](https://online.moysklad.ru/api/remap/1.1/doc/index.html) запрашивают всю необходимую информацию для настройки скидок (информация о покупателях, товарах, магазинах и т.д.).
- В настройках приложения лояльности на стороне МоегоСклада может быть выбран способ поиска покупателей: внутренний (в МоемСкладе) или внешний (в системе лояльности)

После всех настроек МойСклад может производить к системе лояльности следующие запросы:
- Создание покупателя
- Поиск покупателя
- Запрос баланса баллов покупателя
- Расчет скидок для продажи
- Создание продажи
- Создание возврата

Запросы осуществляются на определенный эндпоинт относительно базового адреса. Каждый из запросов содержит в своем составе ключ доступа.

## Обработка ошибок
Если вознникла ошибка при обработке запроса, то она должна приходить с HTTP кодом, отличным от 200 и 201

### Структура ошибок
Ошибки представляют собой массив **errors**, содержащий объекты **error**, каждый из которых описывает отдельную ошибку.

### Структура объекта error
- `error` - Заголовок ошибки
- `parameter` - Параметр, на котором произошла ошибка
- `code` - Код ошибки
- `error_message` - Сообщение, прилагаемое к ошибке.
